"use strict";(self.webpackChunkuser_manual=self.webpackChunkuser_manual||[]).push([[4854],{7896:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"API/agent-interface","title":"AgentInterface","description":"Abstract class to define interacting with a purely RL agent.","source":"@site/adk/API/agent-interface.md","sourceDirName":"API","slug":"/API/agent-interface","permalink":"/adk/API/agent-interface","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"AgentInterface"},"sidebar":"tutorialSidebar","previous":{"title":"API","permalink":"/adk/category/api"},"next":{"title":"BaseAgent","permalink":"/adk/API/base-agent"}}');var i=s(4848),t=s(8453);const d={sidebar_position:1,title:"AgentInterface"},a="class AgentInterface",l={},o=[{value:"Import",id:"import",level:2},{value:"Members",id:"members",level:2},{value:"<code>env: gymnasium.Env</code>",id:"env-gymnasiumenv",level:3},{value:"<code>env_data: EnvData</code>",id:"env_data-envdata",level:3},{value:"<code>agent_data: AgentData</code>",id:"agent_data-agentdata",level:3},{value:"Methods",id:"methods",level:2},{value:"compute_action",id:"compute_action",level:3},{value:"experience",id:"experience",level:3},{value:"learn",id:"learn",level:3},{value:"save_models",id:"save_models",level:3},{value:"load_models",id:"load_models",level:3},{value:"transfer_nn_arch",id:"transfer_nn_arch",level:3},{value:"transfer_specifics",id:"transfer_specifics",level:3},{value:"transfer_models",id:"transfer_models",level:3}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"class-agentinterface",children:"class AgentInterface"})}),"\n",(0,i.jsx)(n.p,{children:"Abstract class to define interacting with a purely RL agent."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"ObservationType"})," and ",(0,i.jsx)(n.code,{children:"ActionType"})," types are ",(0,i.jsx)(n.code,{children:"TypeVar"}),"s because the actual types depend on\r\nthe context."]})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["There should be no visible side effects in the operation of an agent after an agent is saved and\r\nsubsequently loaded with ",(0,i.jsx)(n.code,{children:"save_models"})," and ",(0,i.jsx)(n.code,{children:"load_models"})," respectively. A loaded model must be a\r\n1:1 reconstruction of the respective saved model from an external API's point of view."]})}),"\n",(0,i.jsx)(n.h1,{id:"definition",children:"Definition"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"class AgentInterface(ABC):\r\n    env: gymnasium.Env\r\n    env_data: EnvData\r\n    agent_data: AgentData\r\n\r\n    @abstractmethod\r\n    def compute_action(self, observation: ObservationType, info: dict[str, Any]) -> ActionType: pass\r\n\r\n    @abstractmethod\r\n    def experience(\r\n        self,\r\n        observation: ObservationType,\r\n        action: ActionType,\r\n        reward: SupportsFloat,\r\n        next_observation: ObservationType,\r\n        terminated: bool,\r\n        truncated: bool,\r\n        info: dict[str, Any],\r\n        next_info: dict[str, Any]\r\n    ) -> None: pass\r\n\r\n    @abstractmethod\r\n    def learn(self) -> None: pass\r\n\r\n    @abstractmethod\r\n    def save_models(self, save_to: Path) -> None: pass\r\n\r\n    @abstractmethod\r\n    def load_models(self, load_from: Path) -> None: pass\r\n\r\n    @staticmethod\r\n    @abstractmethod\r\n    def transfer_nn_arch(from_genie_model: GenieModel, transfer_data: TransferModel, from_nn_arch: dict) -> dict: pass\r\n\r\n    @staticmethod\r\n    @abstractmethod\r\n    def transfer_specifics(from_genie_model: GenieModel, transfer_data: TransferModel, from_specifics: dict) -> dict: pass\r\n\r\n    @staticmethod\r\n    @abstractmethod\r\n    def transfer_models(from_genie_model: GenieModel, transfer_data: TransferModel, from_model_path: Path, to_model_path: Path): pass\n"})}),"\n",(0,i.jsx)(n.h2,{id:"import",children:"Import"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"from adk.agent_interface import AgentInterface\n"})}),"\n",(0,i.jsx)(n.h2,{id:"members",children:"Members"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"env-gymnasiumenv",children:(0,i.jsx)(n.code,{children:"env: gymnasium.Env"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": The Gymnasium environment that the agent interacts with."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"env_data-envdata",children:(0,i.jsx)(n.code,{children:"env_data: EnvData"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Information relevant to constructing the internal environment interface. See (",(0,i.jsx)(n.code,{children:"TODO"}),": Refer to ",(0,i.jsx)(n.code,{children:"EnvData"})," once documentation is written) for more info."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"agent_data-agentdata",children:(0,i.jsx)(n.code,{children:"agent_data: AgentData"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Information relevant to constructing the internal agent interface. See (",(0,i.jsx)(n.code,{children:"TODO"}),": Refer to ",(0,i.jsx)(n.code,{children:"AgentData"})," once documentation is written) for more info."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"compute_action",children:"compute_action"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Compute an action based on an ",(0,i.jsx)(n.code,{children:"observation"})," and some ",(0,i.jsx)(n.code,{children:"info"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Takes"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"observation: ObservationType"}),": The observation from the environment."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"info: dict[str, Any]"}),": Auxiliary diagnostic information for the agent (helpful for\r\ndebugging, learning, and logging). This might, for instance, contain: metrics that describe\r\nthe agent's performance state, variables that are hidden from observations, or individual\r\nreward terms that are combined to produce the total reward."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"action: ActionType"}),": Action taken based on the ",(0,i.jsx)(n.code,{children:"observation"})," and ",(0,i.jsx)(n.code,{children:"info"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@abstractmethod\r\ndef compute_action(self, observation: ObservationType, info: dict[str, Any]) -> ActionType: pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"experience",children:"experience"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Append one iteration of the RL ",(0,i.jsx)(n.code,{children:"sars'd"})," loop to the agent's experiences.\r\nThis method is guaranteed to be called exactly once right after ",(0,i.jsx)(n.code,{children:"compute_action"})," is called."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Takes"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"observation: ObservationType"}),": The original observation from the environment,"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"action: ActionType"}),": The action taken based on the original observation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"reward: SupportsFloat"}),": The reward for the action which was taken based on the original observation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"next_observation: ObservationType"}),": The observation obtained after taking the action\r\nbased on the original observation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"terminated: bool"}),": Whether or not the episode ",(0,i.jsx)(n.strong,{children:"terminated"})," (ended by satisfying the task\r\n/ target) after taking the action based on the original observation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"truncated: bool"}),": Whether or not the episode ",(0,i.jsx)(n.strong,{children:"truncated"})," (ended by triggering a boundary\r\ncondition / limit) after taking the action based on the original observation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"info: dict[str, Any]"}),": The original auxiliary diagnostic information."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"next_info: dict[str, Any]"}),": The auxiliary diagnostic information obtained after taking\r\nthe action based on the original observation."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Returns: Nothing"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@abstractmethod\r\ndef experience(self, observation: ObservationType, action: ActionType, reward: SupportsFloat, next_observation: ObservationType, terminated: bool, truncated: bool, info: dict[str, Any], next_info: dict[str, Any]) -> None: pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"learn",children:"learn"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": The agent's internal learn routine. e.g. An RL algorithm using collected\r\nexperiences to train in order to improve performance. This method is guaranteed to be called\r\nexactly once right after ",(0,i.jsx)(n.code,{children:"experience"})," is called."]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Takes: Nothing"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Returns: Nothing"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@abstractmethod\r\ndef learn(self) -> None: pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"save_models",children:"save_models"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Save the agent's internal state to the specified path on the filesystem."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Takes"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"save_to: Path"}),": The filesystem path to which the state is to be saved."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Returns: Nothing"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@abstractmethod\r\ndef save_models(self, save_to: Path) -> None: pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"load_models",children:"load_models"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Load the agent's internal state from the specified path on the filesystem."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Takes"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"load_from: Path"}),": The filesystem path from which the state is to be loaded."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Returns: Nothing"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@abstractmethod\r\ndef load_models(self, load_from: Path) -> None: pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"transfer_nn_arch",children:"transfer_nn_arch"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Static method for transferring neural network architecture from one model to another. Must be implemented by agent implementations."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Takes"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"from_genie_model: GenieModel"}),": The source Genie model."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"transfer_data: TransferModel"}),": Data specifying the transfer configuration."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"from_nn_arch: dict"}),": The neural network architecture dictionary to transfer from."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nn_arch: dict"}),": The transferred neural network architecture dictionary."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@staticmethod\r\n@abstractmethod\r\ndef transfer_nn_arch(from_genie_model: GenieModel, transfer_data: TransferModel, from_nn_arch: dict) -> dict: pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"transfer_specifics",children:"transfer_specifics"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Static method for transferring model specifics from one model to another. Must be implemented by agent implementations."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Takes"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"from_genie_model: GenieModel"}),": The source Genie model."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"transfer_data: TransferModel"}),": Data specifying the transfer configuration."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"from_specifics: dict"}),": The specifics dictionary to transfer from."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"specifics: dict"}),": The transferred specifics dictionary."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@staticmethod\r\n@abstractmethod\r\ndef transfer_specifics(from_genie_model: GenieModel, transfer_data: TransferModel, from_specifics: dict) -> dict: pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"transfer_models",children:"transfer_models"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Static method for transferring trained model files from one location to another. Must be implemented by agent implementations."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Takes"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"from_genie_model: GenieModel"}),": The source Genie model."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"transfer_data: TransferModel"}),": Data specifying the transfer configuration."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"from_model_path: Path"}),": Filesystem path to the source model files."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"to_model_path: Path"}),": Filesystem path to the destination model files."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Returns: Nothing"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Reference"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"@staticmethod\r\n@abstractmethod\r\ndef transfer_models(from_genie_model: GenieModel, transfer_data: TransferModel, from_model_path: Path, to_model_path: Path): pass\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\xa0"})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>a});var r=s(6540);const i={},t=r.createContext(i);function d(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);